<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Module 4: CLI workflows | Advanced prompt engineering</title>
    <link href="https://fonts.googleapis.com/css2?family=Chakra+Petch:wght@300;400;500;600;700&family=Share+Tech+Mono&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="../assets/js/config.js"></script>
    <link rel="stylesheet" href="../assets/css/amditis.css">
    <script src="https://unpkg.com/lucide@latest"></script>
</head>
<body class="antialiased font-mono bg-void text-chrome">
    <a href="#main" class="skip-link">Skip to main content</a>

    <div class="relative z-10 flex min-h-screen flex-col">
        <!-- Header with nav -->
        <header class="border-b border-white/10 bg-panel/50 backdrop-blur-md sticky top-0 z-50">
            <div class="max-w-5xl mx-auto px-6 py-4 flex justify-between items-center">
                <a href="../" class="flex items-center gap-3">
                    <div class="w-8 h-8 bg-acid text-void flex items-center justify-center font-bold font-display text-xl rounded-lg">P</div>
                    <span class="font-display font-bold text-sm tracking-wider text-chrome">PROMPT_ENG</span>
                </a>
                <nav aria-label="Module navigation" class="hidden md:flex gap-4 text-xs font-mono">
                    <a href="../module-1/" class="text-gray-400 hover:text-ice transition-colors">[ 01 ]</a>
                    <a href="../module-2/" class="text-gray-400 hover:text-ice transition-colors">[ 02 ]</a>
                    <a href="../module-3/" class="text-gray-400 hover:text-ice transition-colors">[ 03 ]</a>
                    <a href="../module-4/" class="text-acid">[ 04 ]</a>
                    <a href="../module-5/" class="text-gray-400 hover:text-ice transition-colors">[ 05 ]</a>
                </nav>
            </div>
        </header>

        <!-- Module header -->
        <section class="py-12 px-6 border-b border-white/10">
            <div class="max-w-5xl mx-auto">
                <div class="text-xs text-acid font-mono mb-4">MODULE 04</div>
                <h1 class="font-display text-4xl md:text-5xl font-bold text-white">CLI WORKFLOWS</h1>
                <p class="text-gray-300 text-lg font-mono mt-4 max-w-2xl">Chain commands together, pipe data between tools, and automate repetitive tasks with shell scripts.</p>
            </div>
        </section>

        <!-- Content sections -->
        <main id="main" class="flex-1 max-w-5xl mx-auto w-full px-6 py-12 space-y-16">

            <!-- Learning objectives -->
            <section>
                <div class="border-b border-white/10 pb-4 mb-6">
                    <h2 class="font-display text-xl text-ice">Learning objectives</h2>
                </div>
                <div class="border border-ice/30 bg-iceDim p-6">
                    <ul class="space-y-2 text-sm font-mono text-gray-300">
                        <li class="flex items-start gap-3"><span class="text-ice">></span> Understand Unix pipes and how to chain commands</li>
                        <li class="flex items-start gap-3"><span class="text-ice">></span> Use Claude Code in non-interactive mode for scripting</li>
                        <li class="flex items-start gap-3"><span class="text-ice">></span> Build shell scripts that automate multi-step workflows</li>
                        <li class="flex items-start gap-3"><span class="text-ice">></span> Create a practical content pipeline for journalism work</li>
                    </ul>
                </div>
            </section>

            <!-- Key concepts -->
            <section>
                <div class="border-b border-white/10 pb-4 mb-6">
                    <h2 class="font-display text-xl text-chrome">Key concepts</h2>
                </div>
                <div class="space-y-4">
                    <div class="border border-white/10 bg-panel p-6">
                        <h3 class="font-display text-lg text-acid mb-3">Pipes and redirection</h3>
                        <p class="text-gray-300 text-sm leading-relaxed mb-4">The pipe character (<code class="text-acid bg-surface px-1">|</code>) sends the output of one command as input to another. This lets you build processing chains:</p>
                        <div class="border border-white/10 bg-surface overflow-hidden mb-4">
                            <pre class="p-4 text-sm overflow-x-auto"><code class="text-acid">cat article.txt | wc -w    <span class="text-gray-400"># Count words in article</span>
ls *.txt | wc -l           <span class="text-gray-400"># Count text files</span></code></pre>
                        </div>
                        <p class="text-gray-300 text-sm leading-relaxed">Redirection (<code class="text-acid bg-surface px-1">></code> and <code class="text-acid bg-surface px-1">>></code>) sends output to files instead of the screen. <code class="text-acid bg-surface px-1">></code> overwrites, <code class="text-acid bg-surface px-1">>></code> appends.</p>
                    </div>

                    <div class="border border-white/10 bg-panel p-6">
                        <h3 class="font-display text-lg text-acid mb-3">Non-interactive mode</h3>
                        <p class="text-gray-300 text-sm leading-relaxed mb-4">Claude Code can run as a single command without entering the interactive REPL. This is essential for scripting:</p>
                        <div class="border border-white/10 bg-surface overflow-hidden">
                            <pre class="p-4 text-sm overflow-x-auto"><code class="text-gray-300"><span class="text-gray-400"># Interactive (starts a session)</span>
<span class="text-acid">claude</span>

<span class="text-gray-400"># Non-interactive (runs once and exits)</span>
<span class="text-acid">claude -p "Summarize this article" < article.txt</span></code></pre>
                        </div>
                        <p class="text-gray-400 text-xs mt-2">The <code class="text-acid bg-surface px-1">-p</code> flag specifies the prompt. Input can come from a file or piped from another command.</p>
                    </div>

                    <div class="border border-white/10 bg-panel p-6">
                        <h3 class="font-display text-lg text-acid mb-3">Shell scripts</h3>
                        <p class="text-gray-300 text-sm leading-relaxed">A shell script is a text file containing commands that run in sequence. Scripts let you save and reuse workflows. On macOS and Linux, scripts typically start with <code class="text-acid bg-surface px-1">#!/bin/bash</code> and need execute permission (<code class="text-acid bg-surface px-1">chmod +x script.sh</code>).</p>
                    </div>

                    <div class="border border-white/10 bg-panel p-6">
                        <h3 class="font-display text-lg text-acid mb-3">Variables and loops</h3>
                        <p class="text-gray-300 text-sm leading-relaxed mb-4">Shell scripts can use variables and loops to process multiple files:</p>
                        <div class="border border-white/10 bg-surface overflow-hidden">
                            <pre class="p-4 text-sm overflow-x-auto"><code class="text-acid">for file in *.txt; do
  echo "Processing $file"
  claude -p "Summarize" < "$file" > "${file%.txt}-summary.txt"
done</code></pre>
                        </div>
                        <p class="text-gray-400 text-xs mt-2">This loop processes every <code class="text-acid bg-surface px-1">.txt</code> file and creates a summary for each.</p>
                    </div>
                </div>
            </section>

            <!-- Exercise -->
            <section>
                <div class="border-b border-white/10 pb-4 mb-6">
                    <h2 class="font-display text-xl text-acid">EXERCISE</h2>
                </div>

                <div class="border border-acid/30 bg-acidDim p-6 mb-8">
                    <p class="text-sm font-mono"><span class="text-acid font-bold">GOAL:</span> <span class="text-gray-300">Create a shell script that takes an article, generates a summary, and formats it for a newsletter.</span></p>
                </div>

                <!-- Step 1 -->
                <div class="mb-8">
                    <h3 class="font-display text-lg text-chrome mb-4 flex items-center gap-3">
                        <span class="w-8 h-8 bg-acid text-void flex items-center justify-center font-bold text-sm">01</span>
                        Create a test article
                    </h3>
                    <p class="text-gray-300 text-sm mb-4">First, create a sample article to work with:</p>
                    <div class="border border-white/10 bg-panel overflow-hidden">
                        <div class="bg-surface px-4 py-2 border-b border-white/10 flex items-center gap-2">
                            <div class="w-3 h-3 rounded-full bg-signal/50"></div>
                            <div class="w-3 h-3 rounded-full bg-acid/50"></div>
                            <div class="w-3 h-3 rounded-full bg-ice/50"></div>
                            <span class="text-xs text-gray-400 ml-2 font-mono">terminal</span>
                        </div>
                        <pre class="p-4 text-sm overflow-x-auto"><code class="text-acid">mkdir -p ~/newsletter-pipeline
cd ~/newsletter-pipeline

cat > article.txt <<'EOF'
Local Restaurant Week Returns After Three-Year Hiatus

Downtown merchants announced Tuesday that Restaurant Week will return this March after a three-year pause due to the pandemic. The event, which typically draws thousands of visitors to the city center, will run from March 15-22.

More than 40 restaurants have already signed up to participate, offering prix-fixe lunch and dinner menus at reduced prices. Participating restaurants span cuisines from Italian to Thai, with options ranging from casual cafes to upscale dining rooms.

"We're thrilled to bring this tradition back," said Maria Chen, president of the Downtown Business Association. "Restaurant Week has always been about showcasing the diversity and quality of our local dining scene."

The format will differ slightly from pre-pandemic years. Reservations will be required at all participating restaurants, and some establishments will offer takeout versions of their prix-fixe menus.

A full list of participating restaurants and menus will be available on the Downtown Business Association website starting March 1. Early reservation booking opens March 5 for newsletter subscribers.
EOF</code></pre>
                    </div>
                </div>

                <!-- Step 2 -->
                <div class="mb-8">
                    <h3 class="font-display text-lg text-chrome mb-4 flex items-center gap-3">
                        <span class="w-8 h-8 bg-acid text-void flex items-center justify-center font-bold text-sm">02</span>
                        Test the summarization step
                    </h3>
                    <p class="text-gray-300 text-sm mb-4">First, verify that Claude Code can summarize the article:</p>
                    <div class="border border-white/10 bg-panel overflow-hidden">
                        <div class="bg-surface px-4 py-2 border-b border-white/10 flex items-center gap-2">
                            <div class="w-3 h-3 rounded-full bg-signal/50"></div>
                            <div class="w-3 h-3 rounded-full bg-acid/50"></div>
                            <div class="w-3 h-3 rounded-full bg-ice/50"></div>
                            <span class="text-xs text-gray-400 ml-2 font-mono">terminal</span>
                        </div>
                        <pre class="p-4 text-sm overflow-x-auto"><code class="text-acid">cat article.txt | claude -p "Summarize this article in 2-3 sentences for a newsletter blurb."</code></pre>
                    </div>
                    <p class="text-gray-400 text-xs mt-2">You should see a concise summary printed to your terminal.</p>
                </div>

                <!-- Step 3 -->
                <div class="mb-8">
                    <h3 class="font-display text-lg text-chrome mb-4 flex items-center gap-3">
                        <span class="w-8 h-8 bg-acid text-void flex items-center justify-center font-bold text-sm">03</span>
                        Test the formatting step
                    </h3>
                    <p class="text-gray-300 text-sm mb-4">Now test converting the summary to newsletter format. Save the summary first:</p>
                    <div class="border border-white/10 bg-panel overflow-hidden">
                        <div class="bg-surface px-4 py-2 border-b border-white/10 flex items-center gap-2">
                            <div class="w-3 h-3 rounded-full bg-signal/50"></div>
                            <div class="w-3 h-3 rounded-full bg-acid/50"></div>
                            <div class="w-3 h-3 rounded-full bg-ice/50"></div>
                            <span class="text-xs text-gray-400 ml-2 font-mono">terminal</span>
                        </div>
                        <pre class="p-4 text-sm overflow-x-auto"><code class="text-acid">cat article.txt | claude -p "Summarize this article in 2-3 sentences." > summary.txt

cat summary.txt | claude -p "Format this summary as an HTML snippet for an email newsletter. Include a headline in an h3 tag and the summary in a paragraph tag. Keep it simple, no inline styles."</code></pre>
                    </div>
                </div>

                <!-- Step 4 -->
                <div class="mb-8">
                    <h3 class="font-display text-lg text-chrome mb-4 flex items-center gap-3">
                        <span class="w-8 h-8 bg-acid text-void flex items-center justify-center font-bold text-sm">04</span>
                        Create the pipeline script
                    </h3>
                    <p class="text-gray-300 text-sm mb-4">Now combine these steps into a reusable script:</p>
                    <div class="border border-white/10 bg-panel overflow-hidden">
                        <div class="bg-surface px-4 py-2 border-b border-white/10 flex items-center gap-2">
                            <div class="w-3 h-3 rounded-full bg-signal/50"></div>
                            <div class="w-3 h-3 rounded-full bg-acid/50"></div>
                            <div class="w-3 h-3 rounded-full bg-ice/50"></div>
                            <span class="text-xs text-gray-400 ml-2 font-mono">newsletter-pipeline.sh</span>
                        </div>
                        <pre class="p-4 text-sm overflow-x-auto"><code class="text-gray-300">cat > newsletter-pipeline.sh <<'EOF'
#!/bin/bash

# Newsletter Pipeline Script
# Usage: ./newsletter-pipeline.sh article.txt

if [ -z "$1" ]; then
  echo "Usage: $0 <article-file>"
  exit 1
fi

ARTICLE="$1"
BASENAME=$(basename "$ARTICLE" .txt)
OUTPUT_DIR="./output"

# Create output directory if needed
mkdir -p "$OUTPUT_DIR"

echo "Processing: $ARTICLE"

# Step 1: Generate summary
echo "  Generating summary..."
SUMMARY=$(cat "$ARTICLE" | claude -p "Summarize this article in 2-3 sentences for a newsletter blurb. Be concise and focus on the key news.")

# Step 2: Format for newsletter
echo "  Formatting for newsletter..."
cat <<PROMPT | claude -p "$(cat)" > "$OUTPUT_DIR/${BASENAME}-newsletter.html"
Format this summary as an HTML snippet for an email newsletter:

$SUMMARY

Requirements:
- Use an h3 tag for a compelling headline
- Use a p tag for the summary
- Add a "Read more" link placeholder at the end
- No inline styles, keep it semantic HTML
PROMPT

# Step 3: Also save plain text version
echo "$SUMMARY" > "$OUTPUT_DIR/${BASENAME}-summary.txt"

echo "Done! Output files:"
echo "  $OUTPUT_DIR/${BASENAME}-newsletter.html"
echo "  $OUTPUT_DIR/${BASENAME}-summary.txt"
EOF

chmod +x newsletter-pipeline.sh</code></pre>
                    </div>
                </div>

                <!-- Step 5 -->
                <div class="mb-8">
                    <h3 class="font-display text-lg text-chrome mb-4 flex items-center gap-3">
                        <span class="w-8 h-8 bg-acid text-void flex items-center justify-center font-bold text-sm">05</span>
                        Run the pipeline
                    </h3>
                    <p class="text-gray-300 text-sm mb-4">Execute your script on the test article:</p>
                    <div class="border border-white/10 bg-panel overflow-hidden mb-4">
                        <div class="bg-surface px-4 py-2 border-b border-white/10 flex items-center gap-2">
                            <div class="w-3 h-3 rounded-full bg-signal/50"></div>
                            <div class="w-3 h-3 rounded-full bg-acid/50"></div>
                            <div class="w-3 h-3 rounded-full bg-ice/50"></div>
                            <span class="text-xs text-gray-400 ml-2 font-mono">terminal</span>
                        </div>
                        <pre class="p-4 text-sm overflow-x-auto"><code class="text-acid">./newsletter-pipeline.sh article.txt</code></pre>
                    </div>
                    <p class="text-gray-300 text-sm mb-4">Check the output directory:</p>
                    <div class="border border-white/10 bg-panel overflow-hidden">
                        <div class="bg-surface px-4 py-2 border-b border-white/10 flex items-center gap-2">
                            <div class="w-3 h-3 rounded-full bg-signal/50"></div>
                            <div class="w-3 h-3 rounded-full bg-acid/50"></div>
                            <div class="w-3 h-3 rounded-full bg-ice/50"></div>
                            <span class="text-xs text-gray-400 ml-2 font-mono">terminal</span>
                        </div>
                        <pre class="p-4 text-sm overflow-x-auto"><code class="text-acid">cat output/article-newsletter.html
cat output/article-summary.txt</code></pre>
                    </div>
                </div>

                <!-- Step 6 -->
                <div class="mb-8">
                    <h3 class="font-display text-lg text-chrome mb-4 flex items-center gap-3">
                        <span class="w-8 h-8 bg-acid text-void flex items-center justify-center font-bold text-sm">06</span>
                        Process multiple articles
                    </h3>
                    <p class="text-gray-300 text-sm mb-4">Create a second article and process both:</p>
                    <div class="border border-white/10 bg-panel overflow-hidden">
                        <div class="bg-surface px-4 py-2 border-b border-white/10 flex items-center gap-2">
                            <div class="w-3 h-3 rounded-full bg-signal/50"></div>
                            <div class="w-3 h-3 rounded-full bg-acid/50"></div>
                            <div class="w-3 h-3 rounded-full bg-ice/50"></div>
                            <span class="text-xs text-gray-400 ml-2 font-mono">terminal</span>
                        </div>
                        <pre class="p-4 text-sm overflow-x-auto"><code class="text-acid">cat > article2.txt <<'EOF'
City Council Approves New Bike Lane Network

The city council voted 6-1 Monday night to approve a $4.2 million plan for protected bike lanes connecting downtown to three residential neighborhoods. Construction will begin this summer.

The network will add 12 miles of protected lanes separated from car traffic by concrete barriers. Routes will connect the downtown business district to the Riverside, Hillside, and Eastwood neighborhoods.

Councilmember James Park cast the lone dissenting vote, citing concerns about reduced street parking. Supporters argued the lanes will reduce traffic congestion and provide safe alternatives to driving.
EOF

# Process both articles
for article in article*.txt; do
  ./newsletter-pipeline.sh "$article"
done</code></pre>
                    </div>
                </div>
            </section>

            <!-- Checkpoint questions -->
            <section>
                <div class="border-b border-white/10 pb-4 mb-6">
                    <h2 class="font-display text-xl text-signal">Checkpoint</h2>
                </div>
                <div class="border border-signal/30 bg-signalDim p-6">
                    <p class="text-sm font-mono text-gray-300 mb-4"><span class="text-signal font-bold">Self-check:</span> Make sure you can answer these before moving on.</p>
                    <ul class="space-y-2 text-sm font-mono text-gray-300">
                        <li class="flex items-start gap-3"><span class="text-signal">?</span> What does the pipe character (<code class="text-acid bg-surface px-1">|</code>) do in a shell command?</li>
                        <li class="flex items-start gap-3"><span class="text-signal">?</span> What's the difference between <code class="text-acid bg-surface px-1">></code> and <code class="text-acid bg-surface px-1">>></code> for redirection?</li>
                        <li class="flex items-start gap-3"><span class="text-signal">?</span> How do you run Claude Code non-interactively for use in scripts?</li>
                        <li class="flex items-start gap-3"><span class="text-signal">?</span> What does <code class="text-acid bg-surface px-1">chmod +x</code> do to a file?</li>
                    </ul>
                </div>
            </section>

            <!-- Readings and resources -->
            <section>
                <div class="border-b border-white/10 pb-4 mb-6">
                    <h2 class="font-display text-xl text-chrome">Resources</h2>
                </div>
                <div class="border border-white/10 bg-panel p-6">
                    <ul class="space-y-3 text-sm font-mono">
                        <li><a href="https://www.gnu.org/software/bash/manual/bash.html" target="_blank" rel="noopener" class="text-ice hover:text-acid transition-colors">[DOCS]</a> <span class="text-gray-300">Bash Reference Manual - Complete bash documentation</span></li>
                        <li><a href="https://missing.csail.mit.edu/2020/shell-tools/" target="_blank" rel="noopener" class="text-ice hover:text-acid transition-colors">[COURSE]</a> <span class="text-gray-300">The Missing Semester: Shell Tools - MIT's guide to shell scripting</span></li>
                        <li><a href="https://code.claude.com/docs" target="_blank" rel="noopener" class="text-ice hover:text-acid transition-colors">[REF]</a> <span class="text-gray-300">Claude Code documentation - Non-interactive mode reference</span></li>
                        <li><a href="https://explainshell.com/" target="_blank" rel="noopener" class="text-ice hover:text-acid transition-colors">[TOOL]</a> <span class="text-gray-300">ExplainShell - Paste any shell command to see what each part does</span></li>
                    </ul>
                </div>
            </section>

            <!-- Troubleshooting -->
            <section>
                <div class="border-b border-white/10 pb-4 mb-6">
                    <h2 class="font-display text-xl text-chrome">Troubleshooting</h2>
                </div>
                <div class="border border-white/10 bg-panel divide-y divide-white/5">
                    <div class="p-6">
                        <h4 class="font-mono text-sm text-signal mb-2">"Permission denied" when running the script</h4>
                        <p class="text-gray-400 text-sm">You need to make the script executable: <code class="text-acid bg-surface px-1">chmod +x newsletter-pipeline.sh</code></p>
                    </div>
                    <div class="p-6">
                        <h4 class="font-mono text-sm text-signal mb-2">"command not found: claude"</h4>
                        <p class="text-gray-400 text-sm">Claude Code isn't in your PATH. If you used the native installer (<code class="text-acid bg-surface px-1">curl -fsSL https://claude.ai/install.sh | sh</code>), restart your terminal. See <a href="https://code.claude.com/docs" target="_blank" rel="noopener" class="text-ice hover:text-acid transition-colors">code.claude.com/docs</a> for troubleshooting steps.</p>
                    </div>
                    <div class="p-6">
                        <h4 class="font-mono text-sm text-signal mb-2">Script produces empty output</h4>
                        <p class="text-gray-400 text-sm">Check that the input file exists and isn't empty. Add <code class="text-acid bg-surface px-1">set -e</code> at the top of your script to stop on errors, making problems easier to diagnose.</p>
                    </div>
                    <div class="p-6">
                        <h4 class="font-mono text-sm text-signal mb-2">Special characters in filenames cause errors</h4>
                        <p class="text-gray-400 text-sm">Always quote variable references in scripts: use <code class="text-acid bg-surface px-1">"$file"</code> not <code class="text-acid bg-surface px-1">$file</code>. This handles spaces and special characters correctly.</p>
                    </div>
                </div>
            </section>

        </main>

        <!-- Prev/Next navigation -->
        <footer class="border-t border-white/10 bg-panel">
            <div class="max-w-5xl mx-auto px-6 py-4 flex justify-between">
                <a href="../module-3/" class="text-gray-400 hover:text-white text-sm font-mono transition-colors">Module 03</a>
                <a href="../module-5/" class="text-acid hover:text-white text-sm font-mono transition-colors">Module 05</a>
            </div>
        </footer>
    </div>

    <script>lucide.createIcons();</script>
    <script src="../assets/js/copy-code.js"></script>
</body>
</html>
